<div class="modal-overlay" (click)="cerrar()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="cerrar()">&times;</button>
    
    <div class="modal-header">
      <div class="whatsapp-icon">ğŸ“±</div>
      <h2>Configurar WhatsApp</h2>
    </div>

    <div class="modal-body">
      <!-- Mensaje diferente segÃºn el rol -->
      @if (userRole() === 'usuario') {
        <p class="instruction">
          Si desea <strong>enviar solicitudes de tutorÃ­as y recibir la respuesta</strong> por WhatsApp, siga los siguientes pasos:
        </p>
      } @else {
        <p class="instruction">
          Si desea <strong>recibir solicitudes de tutorÃ­as y enviar la respuesta</strong> por WhatsApp, siga los siguientes pasos:
        </p>
      }

      <!-- Paso 1: Agregar nÃºmero propio -->
      <div class="step">
        <div class="step-number">1</div>
        <div class="step-content">
          <label>Ingrese su nÃºmero de WhatsApp:</label>
          <input 
            type="tel" 
            [(ngModel)]="telefono" 
            (input)="validarTelefono()"
            placeholder="Ej: 0987654321 o +593987654321"
            class="phone-input"
            [class.error]="mostrarError"
          />
          @if (mostrarError) {
            <span class="error-message">{{ mensajeError }}</span>
          }
          @if (telefonoValido) {
            <span class="success-message">âœ… NÃºmero vÃ¡lido: {{ telefono }}</span>
          }
        </div>
      </div>

      <!-- Paso 2: Agregar nÃºmero de Twilio -->
      <div class="step">
        <div class="step-number">2</div>
        <div class="step-content">
          <label>Agregue este nÃºmero a sus contactos de WhatsApp:</label>
          <div class="copy-container">
            <input 
              type="text" 
              [value]="TWILIO_NUMBER" 
              readonly 
              class="readonly-input"
            />
            <button class="copy-btn" (click)="copiarNumero()">ğŸ“‹ Copiar</button>
          </div>
        </div>
      </div>

      <!-- Paso 3: Enviar mensaje -->
      <div class="step">
        <div class="step-number">3</div>
        <div class="step-content">
          <label>EnvÃ­e este mensaje al nÃºmero de Twilio:</label>
          <div class="copy-container">
            <input 
              type="text" 
              [value]="JOIN_MESSAGE" 
              readonly 
              class="readonly-input message-input"
            />
            <button class="copy-btn" (click)="copiarMensaje()">ğŸ“‹ Copiar</button>
          </div>
        </div>
      </div>

      <!-- Nota importante -->
      <div class="info-box">
        <strong>ğŸ“Œ Importante:</strong> Debe completar los 3 pasos para recibir notificaciones por WhatsApp. 
        El sistema enviarÃ¡ automÃ¡ticamente los mensajes a su nÃºmero registrado.
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="agregarMasTarde()">
        â° Agregar mÃ¡s tarde
      </button>
      <button 
        class="btn-primary" 
        [disabled]="!telefonoValido"
        (click)="agregarTelefono()"
      >
        âœ… Guardar nÃºmero
      </button>
    </div>
  </div>
</div>
